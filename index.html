<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Farming CBA Decision Tool 2 - Newcastle Business School</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body data-theme="worldbank-light">
  <div id="toast-root" aria-live="polite" aria-atomic="true"></div>
  <div id="tooltip" role="tooltip" class="tooltip" aria-hidden="true"></div>

  <header class="app-header">
    <div class="brand" role="banner">
      <div class="brand-mark" aria-label="Newcastle Business School">NBS</div>
      <div class="brand-text">
        <div class="brand-title">Farming CBA Decision Tool 2</div>
        <div class="brand-subtitle">Newcastle Business School</div>
      </div>
    </div>

    <div class="header-actions" role="group" aria-label="Project actions">
      <button id="startBtn" class="btn primary" type="button">Start with project setup</button>
      <button id="saveProject" class="btn ghost" type="button">Save project (JSON)</button>
      <button id="loadProject" class="btn ghost" type="button">Load project</button>
      <input type="file" id="loadFile" accept=".json" hidden />
    </div>
  </header>

  <main class="app-main">
    <nav class="tabs-nav" aria-label="Main sections">
      <button type="button" class="tab-link active" data-tab="intro" aria-selected="true">Introduction</button>
      <button type="button" class="tab-link" data-tab="project" aria-selected="false">Project</button>
      <button type="button" class="tab-link" data-tab="settings" aria-selected="false">Time and risk settings</button>
      <button type="button" class="tab-link" data-tab="outputs" aria-selected="false">Outputs</button>
      <button type="button" class="tab-link" data-tab="treatments" aria-selected="false">Treatments</button>
      <button type="button" class="tab-link" data-tab="benefits" aria-selected="false">Additional benefits</button>
      <button type="button" class="tab-link" data-tab="costs" aria-selected="false">Other costs</button>
      <button type="button" class="tab-link" data-tab="database" aria-selected="false">Sources</button>
      <button type="button" class="tab-link" data-tab="results" aria-selected="false">Results</button>
      <button type="button" class="tab-link" data-tab="simulation" aria-selected="false">Simulation</button>
      <button type="button" class="tab-link" data-tab="excel" aria-selected="false">Excel import and export</button>
      <button type="button" class="tab-link" data-tab="copilot" aria-selected="false">AI interpretation helper</button>
      <button type="button" class="tab-link" data-tab="appendix" aria-selected="false">Technical appendix</button>
    </nav>

    <!-- INTRO -->
    <section class="tab-panel active show" id="tab-intro" data-tab-panel="intro" aria-hidden="false">
      <div class="card">
        <h1>Farming CBA Decision Tool 2</h1>
        <p>
          This tool compares farm treatments against a control using a clear, side-by-side cost–benefit view.
          The default example is a 2022 faba bean soil amendment trial dataset (included in full in the Sources tab
          and in the sample Excel download).
        </p>
        <p>
          Use the Results tab for a snapshot view (control and treatments in one table). Use the Excel tab for an
          Excel-first workflow: download a template, edit it in Excel, and import it back with validation.
        </p>
        <div class="intro-actions">
          <button id="startBtn-duplicate" class="btn primary" type="button" data-tab-jump="project">Go to project setup</button>
          <button class="btn" type="button" data-tab-jump="treatments">Jump to treatments</button>
          <button class="btn" type="button" data-tab-jump="results">Jump to results</button>
        </div>
      </div>
    </section>

    <!-- PROJECT -->
    <section class="tab-panel" id="tab-project" data-tab-panel="project" aria-hidden="true">
      <div class="card">
        <h2>Project description</h2>

        <div class="row-3">
          <div class="field">
            <label for="projectName" data-tooltip="Short title for the farm trial or investment project.">Project name</label>
            <input id="projectName" type="text" />
          </div>
          <div class="field">
            <label for="projectLead" data-tooltip="Person with overall responsibility for the project.">Project lead</label>
            <input id="projectLead" type="text" />
          </div>
          <div class="field">
            <label for="analystNames" data-tooltip="People who prepared the cost–benefit analysis.">Analyst team</label>
            <input id="analystNames" type="text" />
          </div>
        </div>

        <div class="row-3">
          <div class="field">
            <label for="projectTeam" data-tooltip="Delivery partners or trial team involved in implementation.">Partners or trial team</label>
            <input id="projectTeam" type="text" />
          </div>
          <div class="field">
            <label for="organisation" data-tooltip="Host organisation for the analysis or project.">Organisation</label>
            <input id="organisation" type="text" />
          </div>
          <div class="field">
            <label for="lastUpdated" data-tooltip="Date when the analysis was last updated.">Last updated</label>
            <input id="lastUpdated" type="date" />
          </div>
        </div>

        <div class="row-3">
          <div class="field">
            <label for="contactEmail" data-tooltip="Contact email for questions about the analysis.">Contact email</label>
            <input id="contactEmail" type="email" />
          </div>
          <div class="field">
            <label for="contactPhone" data-tooltip="Optional phone contact for follow up.">Contact phone</label>
            <input id="contactPhone" type="tel" />
          </div>
          <div class="field"></div>
        </div>

        <div class="field">
          <label for="projectSummary" data-tooltip="Short plain-language description of the project and trial.">Short summary</label>
          <textarea id="projectSummary" rows="3"></textarea>
        </div>

        <div class="field">
          <label for="projectGoal" data-tooltip="Main goal in terms of production, profit, or risk reduction.">Project goal</label>
          <textarea id="projectGoal" rows="2"></textarea>
        </div>

        <div class="row-2">
          <div class="field">
            <label for="withProject" data-tooltip="What happens with the treatments in place.">With project (change story)</label>
            <textarea id="withProject" rows="3"></textarea>
          </div>
          <div class="field">
            <label for="withoutProject" data-tooltip="What happens under business as usual conditions.">Without project (baseline story)</label>
            <textarea id="withoutProject" rows="3"></textarea>
          </div>
        </div>

        <div class="field">
          <label for="projectObjectives" data-tooltip="Specific measurable objectives for the project.">Key objectives</label>
          <textarea id="projectObjectives" rows="3"></textarea>
        </div>

        <div class="field">
          <label for="projectActivities" data-tooltip="Main activities delivering the change (e.g., treatments, extension, monitoring).">Main activities</label>
          <textarea id="projectActivities" rows="3"></textarea>
        </div>

        <div class="field">
          <label for="stakeholderGroups" data-tooltip="Key stakeholder groups who gain, lose, or are involved.">Stakeholder groups</label>
          <textarea id="stakeholderGroups" rows="3"></textarea>
        </div>
      </div>
    </section>

    <!-- SETTINGS -->
    <section class="tab-panel" id="tab-settings" data-tab-panel="settings" aria-hidden="true">
      <div class="card">
        <h2>Time horizon, adoption, and risk</h2>

        <div class="row-4">
          <div class="field">
            <label for="startYear" data-tooltip="Calendar year for reporting.">Analysis start year</label>
            <input id="startYear" type="number" />
          </div>
          <div class="field">
            <label for="years" data-tooltip="Number of years for annual benefits and annual operating costs.">Years of analysis</label>
            <input id="years" type="number" min="1" />
          </div>
          <div class="field">
            <label for="discBase" data-tooltip="Base discount rate used for present value calculations.">Discount rate (base, %)</label>
            <input id="discBase" type="number" step="0.1" />
          </div>
          <div class="field">
            <label for="systemType" data-tooltip="Single farm analysis or roll-out across multiple farms.">System type</label>
            <select id="systemType">
              <option value="single">Single farm or system</option>
              <option value="multiple">Multiple farms or systems</option>
            </select>
          </div>
        </div>

        <div class="row-4">
          <div class="field">
            <label for="adoptLow" data-tooltip="Lower bound used in simulation.">Adoption low (0–1)</label>
            <input id="adoptLow" type="number" step="0.05" min="0" max="1" />
          </div>
          <div class="field">
            <label for="adoptBase" data-tooltip="Base adoption multiplier applied to all treatments (treatment-level adoption still applies).">Adoption base (0–1)</label>
            <input id="adoptBase" type="number" step="0.05" min="0" max="1" />
          </div>
          <div class="field">
            <label for="adoptHigh" data-tooltip="Upper bound used in simulation.">Adoption high (0–1)</label>
            <input id="adoptHigh" type="number" step="0.05" min="0" max="1" />
          </div>
          <div class="field">
            <label for="riskBase" data-tooltip="Base risk reduces effective benefits (benefits × (1−risk)).">Overall risk base (0–1)</label>
            <input id="riskBase" type="number" step="0.01" min="0" max="1" />
          </div>
        </div>

        <div class="row-4">
          <div class="field">
            <label for="riskLow" data-tooltip="Lower bound used in simulation.">Risk low (0–1)</label>
            <input id="riskLow" type="number" step="0.01" min="0" max="1" />
          </div>
          <div class="field">
            <label for="riskHigh" data-tooltip="Upper bound used in simulation.">Risk high (0–1)</label>
            <input id="riskHigh" type="number" step="0.01" min="0" max="1" />
          </div>
          <div class="field">
            <label for="assumeExtraCostsOneOff" data-tooltip="If ON (recommended for the default faba bean dataset), treatment extra costs are treated as year 0 capital costs; annual operating costs default to the control operating cost.">
              Assume treatment extra costs are one-off (year 0)
            </label>
            <select id="assumeExtraCostsOneOff">
              <option value="true">On (one-off)</option>
              <option value="false">Off (annual)</option>
            </select>
          </div>
          <div class="field">
            <label for="outputAssumptions" data-tooltip="Notes on prices, yields, and how you interpret the raw data.">Notes on general assumptions</label>
            <textarea id="outputAssumptions" rows="2"></textarea>
          </div>
        </div>
      </div>
    </section>

    <!-- OUTPUTS -->
    <section class="tab-panel" id="tab-outputs" data-tab-panel="outputs" aria-hidden="true">
      <div class="card">
        <h2>Outputs and valuation</h2>
        <p class="small muted">
          Outputs are measured per hectare. Unit value links the output to dollars (for example yield × grain price).
          Treatment-level output levels are entered in the Treatments tab.
        </p>
        <div class="toolbar">
          <button id="addOutput" class="btn small" type="button">Add output</button>
        </div>
        <div id="outputsList" class="item-list"></div>
      </div>
    </section>

    <!-- TREATMENTS -->
    <section class="tab-panel" id="tab-treatments" data-tab-panel="treatments" aria-hidden="true">
      <div class="card">
        <div class="row-2">
          <div class="field">
            <h2>Treatments and control</h2>
            <p class="small muted">
              The Results table compares all treatments side-by-side, with the control included.
              Output levels are entered per treatment. Costs update dynamically as you change cost components.
            </p>
          </div>
          <div class="field right">
            <button id="addTreatment" class="btn small" type="button">Add treatment</button>
          </div>
        </div>
        <div id="treatmentsList" class="item-list"></div>
      </div>
    </section>

    <!-- BENEFITS -->
    <section class="tab-panel" id="tab-benefits" data-tab-panel="benefits" aria-hidden="true">
      <div class="card">
        <h2>Additional benefits</h2>
        <p class="small muted">
          Optional project-wide benefits (e.g., avoided losses, cost savings) that apply across scenarios.
        </p>
        <div class="toolbar">
          <button id="addBenefit" class="btn small" type="button">Add benefit</button>
        </div>
        <div id="benefitsList" class="item-list"></div>
      </div>
    </section>

    <!-- COSTS -->
    <section class="tab-panel" id="tab-costs" data-tab-panel="costs" aria-hidden="true">
      <div class="card">
        <h2>Other project costs</h2>
        <p class="small muted">
          Optional project-wide costs (e.g., monitoring, admin). These apply across scenarios unless you handle them separately in Excel.
        </p>
        <div class="toolbar">
          <button id="addCost" class="btn small" type="button">Add cost item</button>
        </div>
        <div id="costsList" class="item-list"></div>
      </div>
    </section>

    <!-- SOURCES -->
    <section class="tab-panel" id="tab-database" data-tab-panel="database" aria-hidden="true">
      <div class="card">
        <h2>Sources and default dataset</h2>
        <p class="small muted">
          The default 2022 faba bean dataset is included in full below (raw rows), and a structured key-column version is used for calibration.
          The same content is included in the sample Excel download.
        </p>

        <div class="row-2">
          <div class="field">
            <h3>Calibration summary (used by the tool)</h3>
            <div id="calibrationSummary" class="table-scroll"></div>
          </div>
          <div class="field">
            <h3>Raw dataset (included in full)</h3>
            <div class="toolbar">
              <button id="copyRawData" class="btn small" type="button">Copy raw dataset</button>
              <button id="downloadRawData" class="btn small ghost" type="button">Download raw dataset (TSV)</button>
            </div>
            <textarea id="rawDataBox" class="mono" rows="14" readonly></textarea>
          </div>
        </div>
      </div>
    </section>

    <!-- RESULTS -->
    <section class="tab-panel" id="tab-results" data-tab-panel="results" aria-hidden="true">
      <div class="card">
        <div class="results-header">
          <h2>Results snapshot</h2>
          <div class="actions-inline">
            <button id="recalc" class="btn primary" type="button">Recalculate results</button>
          </div>
        </div>

        <div class="row-3">
          <div class="field">
            <label for="resultsSort" data-tooltip="Sorts treatment columns left-to-right (control stays first).">Sort treatments by</label>
            <select id="resultsSort">
              <option value="npv_desc">NPV (high to low)</option>
              <option value="bcr_desc">BCR (high to low)</option>
              <option value="roi_desc">ROI (high to low)</option>
              <option value="pvbenefits_desc">PV benefits (high to low)</option>
              <option value="pvcosts_asc">PV costs (low to high)</option>
              <option value="name_asc">Name (A to Z)</option>
            </select>
          </div>
          <div class="field">
            <label for="showDeltaLine" data-tooltip="Shows a small comparison line inside each cell (vs control).">Show comparison line</label>
            <select id="showDeltaLine">
              <option value="true">On</option>
              <option value="false">Off</option>
            </select>
          </div>
          <div class="field">
            <label for="resultsIndicators" data-tooltip="Core shows the headline decision metrics. Full adds IRR and payback.">Indicators</label>
            <select id="resultsIndicators">
              <option value="core">Core</option>
              <option value="full">Full</option>
            </select>
          </div>
        </div>

        <div class="row-2">
          <div class="card subtle">
            <h3>Headline (base case)</h3>
            <div class="row-4 metrics-grid">
              <div class="metricBox">
                <div class="metricLabel" data-tooltip="Present value of benefits minus present value of costs (base discount rate).">NPV (best treatment)</div>
                <div id="headlineBestNPV" class="metricValue">n/a</div>
                <div id="headlineBestNPVName" class="small muted">n/a</div>
              </div>
              <div class="metricBox">
                <div class="metricLabel" data-tooltip="Benefit–cost ratio (PV benefits divided by PV costs).">BCR (best treatment)</div>
                <div id="headlineBestBCR" class="metricValue">n/a</div>
                <div id="headlineBestBCRName" class="small muted">n/a</div>
              </div>
              <div class="metricBox">
                <div class="metricLabel" data-tooltip="Return on investment (NPV divided by PV costs).">ROI (best treatment)</div>
                <div id="headlineBestROI" class="metricValue">n/a</div>
                <div id="headlineBestROIName" class="small muted">n/a</div>
              </div>
              <div class="metricBox">
                <div class="metricLabel" data-tooltip="Which scenario is used as the control in comparisons.">Control</div>
                <div id="headlineControlName" class="metricValue small">n/a</div>
                <div class="small muted">Included as first column</div>
              </div>
            </div>
          </div>

          <div class="card subtle">
            <h3>Exports</h3>
            <div class="row-2">
              <button id="copyResultsTable" class="btn" type="button">Copy table for Word</button>
              <button id="exportExcelResults" class="btn ghost" type="button">Export results (Excel)</button>
            </div>
            <div class="row-2">
              <button id="exportCsv" class="btn" type="button">Export results (CSV)</button>
              <button id="exportPdf" class="btn ghost" type="button">Print / Save as PDF</button>
            </div>
            <p class="small muted">
              The table is designed to paste cleanly into Word and export cleanly into Excel.
            </p>
          </div>
        </div>

        <h3>Control and treatment comparison table</h3>
        <p class="small muted">
          Indicators are rows. Treatments are columns. The control is included alongside all treatments for direct comparison.
        </p>

        <div id="comparisonTableWrap" class="table-scroll"></div>

        <hr />

        <h3>Why does a treatment look good or bad?</h3>
        <div class="row-2">
          <div class="field">
            <label for="detailTreatment" data-tooltip="Shows a simple breakdown for one selected treatment.">Select a treatment</label>
            <select id="detailTreatment"></select>
          </div>
          <div class="field">
            <label data-tooltip="Breakdown of annual revenue (from outputs) and costs (annual + year 0 capital), plus the control comparison.">Breakdown</label>
            <div id="treatmentBreakdown" class="breakdownBox"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- SIMULATION -->
    <section class="tab-panel" id="tab-simulation" data-tab-panel="simulation" aria-hidden="true">
      <div class="card">
        <div class="results-header">
          <h2>Monte Carlo simulation</h2>
          <button id="runSim" class="btn primary" type="button">Run simulation</button>
        </div>

        <p class="small muted">
          Simulation varies discount rate, adoption, risk, and (optionally) output values and costs within the ranges set in Settings.
          It does not hide low-performing treatments. Use it to explore sensitivity.
        </p>

        <div class="row-4">
          <div class="field">
            <label for="simTarget" data-tooltip="Choose which treatment to simulate (control is included for comparison).">Simulate treatment</label>
            <select id="simTarget"></select>
          </div>
          <div class="field">
            <label for="simN" data-tooltip="Number of random draws. Larger values are smoother but slower.">Number of runs</label>
            <input id="simN" type="number" min="100" step="100" />
          </div>
          <div class="field">
            <label for="simVarPct" data-tooltip="Percent variation applied to selected inputs.">Variation size (%)</label>
            <input id="simVarPct" type="number" min="0" max="100" step="1" />
          </div>
          <div class="field">
            <label for="randSeed" data-tooltip="Optional seed for repeatable simulation. Leave blank for a new draw each run.">Random seed (optional)</label>
            <input id="randSeed" type="number" />
          </div>
        </div>

        <div class="row-4">
          <div class="field">
            <label for="simVaryOutputs" data-tooltip="Randomly varies output unit values (e.g., price).">Vary output values</label>
            <select id="simVaryOutputs">
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div class="field">
            <label for="simVaryTreatCosts" data-tooltip="Randomly varies treatment costs.">Vary treatment costs</label>
            <select id="simVaryTreatCosts">
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div class="field">
            <label for="simTargetBcr" data-tooltip="Used only to report the share of runs above a target. It does not impose any rule.">Target BCR (for reporting)</label>
            <input id="simTargetBcr" type="number" step="0.1" min="0" />
          </div>
          <div class="field">
            <label for="simStatus" data-tooltip="Shows progress and basic checks.">Status</label>
            <div id="simStatus" class="small muted">Simulation not run yet.</div>
          </div>
        </div>

        <hr />

        <h3>Simulation summary</h3>
        <div class="row-2">
          <div class="card subtle">
            <h4>Net present value</h4>
            <div class="row-4 metrics-grid">
              <div class="metricBox"><div class="metricLabel">Min</div><div id="simNpvMin" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Max</div><div id="simNpvMax" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Mean</div><div id="simNpvMean" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Median</div><div id="simNpvMedian" class="metricValue small">n/a</div></div>
            </div>
            <div class="row-2 metrics-grid">
              <div class="metricBox"><div class="metricLabel">Pr(NPV &gt; 0)</div><div id="simNpvProb" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Pr(NPV &gt; control)</div><div id="simNpvProbCtrl" class="metricValue small">n/a</div></div>
            </div>
          </div>

          <div class="card subtle">
            <h4>Benefit–cost ratio</h4>
            <div class="row-4 metrics-grid">
              <div class="metricBox"><div class="metricLabel">Min</div><div id="simBcrMin" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Max</div><div id="simBcrMax" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Mean</div><div id="simBcrMean" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Median</div><div id="simBcrMedian" class="metricValue small">n/a</div></div>
            </div>
            <div class="row-3 metrics-grid">
              <div class="metricBox"><div class="metricLabel">Pr(BCR &gt; 1)</div><div id="simBcrProb1" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Pr(BCR &gt; target)</div><div id="simBcrProbTarget" class="metricValue small">n/a</div></div>
              <div class="metricBox"><div class="metricLabel">Pr(BCR &gt; control)</div><div id="simBcrProbCtrl" class="metricValue small">n/a</div></div>
            </div>
          </div>
        </div>

        <hr />

        <h3>Distributions</h3>
        <div class="row-2">
          <div class="field">
            <canvas id="histNpv" width="520" height="260"></canvas>
          </div>
          <div class="field">
            <canvas id="histBcr" width="520" height="260"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- EXCEL -->
    <section class="tab-panel" id="tab-excel" data-tab-panel="excel" aria-hidden="true">
      <div class="card">
        <h2>Excel import and export</h2>
        <p class="small muted">
          Excel-first workflow: download a template or a scenario-specific workbook, edit in Excel, then import back.
          The tool validates structure and shows a parse report before you apply changes.
        </p>

        <div class="row-2">
          <div class="field">
            <h3>Download</h3>
            <button id="downloadTemplate" class="btn" type="button">Download blank template</button>
            <button id="downloadSample" class="btn ghost" type="button">Download sample (includes default dataset)</button>
          </div>
          <div class="field">
            <h3>Import</h3>
            <div class="toolbar">
              <button id="parseExcel" class="btn" type="button">Parse Excel file</button>
              <button id="importExcel" class="btn ghost" type="button">Apply parsed Excel data</button>
              <input type="file" id="excelFile" accept=".xlsx,.xls" hidden />
            </div>
            <div id="excelParseReport" class="small muted" style="margin-top:8px;">No workbook parsed yet.</div>
          </div>
        </div>

        <hr />
        <h3>What gets imported?</h3>
        <p class="small muted">
          The importer looks for sheets named: Project, Settings, Outputs, Treatments, Benefits, OtherCosts, and (optional) FabaBeans_2022_KeyColumns and FabaBeans_2022_RawRows.
          If a sheet is missing, the tool keeps the current values for that section.
        </p>
      </div>
    </section>

    <!-- AI HELPER -->
    <section class="tab-panel" id="tab-copilot" data-tab-panel="copilot" aria-hidden="true">
      <div class="card">
        <h2>AI-assisted interpretation helper</h2>
        <p class="small muted">
          This generates a structured prompt (plus results payload) you can paste into Copilot, ChatGPT, or another model.
          It explains what the indicators mean, highlights trade-offs, and suggests practical improvement pathways when performance is weak.
          It does not tell the user what to choose.
        </p>

        <div class="row-2">
          <div class="field">
            <button id="generateAiPrompt" class="btn primary" type="button">Generate and copy prompt</button>
            <button id="downloadAiPrompt" class="btn ghost" type="button">Download prompt (.txt)</button>
            <p class="small muted" id="aiPromptStatus">Prompt not generated yet.</p>
          </div>
          <div class="field">
            <label for="copilotPreview" data-tooltip="This is the exact prompt copied by the button.">Prompt preview</label>
            <textarea id="copilotPreview" rows="14" readonly class="mono"></textarea>
          </div>
        </div>
      </div>
    </section>

    <!-- APPENDIX -->
    <section class="tab-panel" id="tab-appendix" data-tab-panel="appendix" aria-hidden="true">
      <div class="card">
        <h2>Technical appendix and user guide</h2>
        <p class="small muted">
          Full indicator definitions, formulas, and the Excel template specification are in the appendix.
        </p>
        <div class="row-2">
          <div class="field">
            <button type="button" class="btn primary" onclick="window.open('technical-appendix.html','_blank','noopener');">
              Open technical appendix (new tab)
            </button>
          </div>
          <div class="field">
            <a href="technical-appendix.html" target="_blank" rel="noopener" class="small">Open technical-appendix.html</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <div class="footer-left">
      <span class="small muted">Farming CBA Decision Tool 2, Newcastle Business School</span>
    </div>
    <div class="footer-right">
      <button id="exportCsvFoot" class="btn small" type="button">Export CSV</button>
      <button id="exportPdfFoot" class="btn small ghost" type="button">Print / PDF</button>
    </div>
  </footer>

  <!-- SheetJS (Excel import/export) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
