<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Technical Appendix - Farming CBA Decision Tool 2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="description" content="Technical appendix and user guide for Farming CBA Decision Tool 2 (AUD). Explains the results snapshot table, Excel-first workflow, indicators, formulas, simulation, and AI interpretation prompts." />
  <meta name="theme-color" content="#1d4f91" />

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="stylesheet" href="styles.css" />

  <style>
    .appendix-main {
      max-width: var(--container-max, 1240px);
      margin: 1.5rem auto 2.5rem;
      padding: 0 var(--container-pad, 1.25rem) 1.5rem;
    }

    .appendix-hero {
      border-radius: 18px;
      border: 1px solid rgba(226, 232, 240, 0.9);
      background: linear-gradient(135deg, rgba(224, 236, 255, 0.65), rgba(255, 255, 255, 0.92));
      box-shadow: var(--shadow-soft, 0 10px 25px rgba(15, 23, 42, 0.05));
      padding: 1rem 1.15rem;
      margin-bottom: 1.1rem;
    }

    body[data-theme="worldbank-dark"] .appendix-hero {
      border: 1px solid rgba(148, 163, 184, 0.18);
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.16), rgba(15, 23, 42, 0.75));
      box-shadow: var(--shadow-soft);
    }

    .appendix-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 1.25rem;
    }

    .appendix-title-block {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      min-width: 0;
    }

    .appendix-kicker {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--color-text-muted);
    }

    .appendix-title {
      font-size: 1.55rem;
      font-weight: 700;
      color: var(--color-text);
      letter-spacing: -0.02em;
      line-height: 1.15;
    }

    .appendix-subtitle {
      font-size: 0.9rem;
      color: var(--color-text-muted);
      line-height: 1.45;
      max-width: 80ch;
    }

    .appendix-header-actions {
      display: inline-flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.15rem;
    }

    .appendix-meta-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.45rem;
      margin-top: 0.55rem;
    }

    .appendix-chip {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.18rem 0.6rem;
      border-radius: 999px;
      font-size: 0.78rem;
      font-weight: 600;
      border: 1px solid rgba(209, 213, 219, 0.9);
      background: rgba(255, 255, 255, 0.75);
      color: var(--color-text);
      user-select: none;
    }

    body[data-theme="worldbank-dark"] .appendix-chip {
      border-color: rgba(148, 163, 184, 0.22);
      background: rgba(15, 23, 42, 0.4);
      color: var(--color-text);
    }

    .appendix-chip .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(29, 79, 145, 0.14);
    }

    body[data-theme="worldbank-dark"] .appendix-chip .dot {
      box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.18);
    }

    .appendix-toc {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 0.5rem;
      margin-top: 0.85rem;
    }

    .appendix-toc .toc-title {
      font-size: 0.82rem;
      font-weight: 700;
      color: var(--color-text);
      letter-spacing: -0.01em;
      margin: 0;
    }

    .appendix-toc-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.55rem;
    }

    .toc-link {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.7rem;
      text-decoration: none;
      border-radius: 14px;
      border: 1px solid rgba(226, 232, 240, 0.9);
      background: rgba(255, 255, 255, 0.7);
      padding: 0.65rem 0.75rem;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast);
      color: var(--color-text);
    }

    body[data-theme="worldbank-dark"] .toc-link {
      background: rgba(15, 23, 42, 0.45);
      border-color: rgba(148, 163, 184, 0.16);
    }

    .toc-link:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-soft);
      border-color: rgba(29, 79, 145, 0.25);
    }

    .toc-link .label {
      font-size: 0.86rem;
      font-weight: 700;
      letter-spacing: -0.01em;
      line-height: 1.2;
    }

    .toc-link .hint {
      font-size: 0.78rem;
      color: var(--color-text-muted);
      line-height: 1.2;
      text-align: right;
      white-space: nowrap;
    }

    .appendix-section {
      margin-bottom: 1.2rem;
    }

    .appendix-section h2 {
      font-size: 1.15rem;
      margin-bottom: 0.45rem;
      letter-spacing: -0.01em;
    }

    .appendix-section h3 {
      font-size: 1.0rem;
      margin-top: 0.8rem;
      margin-bottom: 0.35rem;
      letter-spacing: -0.01em;
    }

    .appendix-section p {
      font-size: 0.92rem;
      line-height: 1.6;
      margin: 0 0 0.55rem;
      color: var(--color-text);
    }

    .appendix-note {
      font-size: 0.82rem;
      color: var(--color-text-muted);
      border-left: 3px solid var(--color-primary);
      padding-left: 0.7rem;
      margin-top: 0.3rem;
      margin-bottom: 0.65rem;
    }

    .appendix-callout {
      border-radius: 14px;
      border: 1px solid var(--color-border);
      background: rgba(249, 250, 251, 0.9);
      padding: 0.75rem 0.85rem;
      margin: 0.5rem 0 0.75rem;
      font-size: 0.9rem;
      line-height: 1.55;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.04);
    }

    body[data-theme="worldbank-dark"] .appendix-callout {
      background: rgba(15, 23, 42, 0.55);
      border-color: rgba(148, 163, 184, 0.18);
      box-shadow: var(--shadow-soft);
    }

    .appendix-callout p {
      margin-bottom: 0.35rem;
    }

    .appendix-callout strong {
      font-weight: 800;
    }

    .appendix-table-wrapper {
      width: 100%;
      overflow-x: auto;
      padding-bottom: 0.3rem;
      margin-top: 0.35rem;
      margin-bottom: 0.75rem;
      -webkit-overflow-scrolling: touch;
      border-radius: 12px;
    }

    .appendix-table {
      width: 100%;
      min-width: 720px;
      border-collapse: collapse;
      font-size: 0.82rem;
    }

    .appendix-table thead {
      background: rgba(241, 245, 249, 0.95);
    }

    body[data-theme="worldbank-dark"] .appendix-table thead {
      background: rgba(148, 163, 184, 0.12);
    }

    .appendix-table th,
    .appendix-table td {
      border: 1px solid var(--color-border);
      padding: 0.42rem 0.55rem;
      text-align: left;
      vertical-align: top;
    }

    .appendix-table th {
      font-weight: 800;
      color: var(--color-text);
      white-space: nowrap;
    }

    .appendix-table tbody tr:nth-child(even) {
      background: rgba(249, 250, 251, 0.75);
    }

    body[data-theme="worldbank-dark"] .appendix-table tbody tr:nth-child(even) {
      background: rgba(15, 23, 42, 0.45);
    }

    .appendix-math {
      font-family: "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.84rem;
      background: #0b1120;
      color: #e5e7eb;
      border-radius: 12px;
      padding: 0.7rem 0.8rem;
      margin: 0.45rem 0 0.7rem;
      white-space: pre-wrap;
      border: 1px solid rgba(17, 24, 39, 0.9);
      box-shadow: 0 10px 24px rgba(2, 6, 23, 0.14);
    }

    body[data-theme="worldbank-dark"] .appendix-math {
      background: #070c18;
      border-color: rgba(148, 163, 184, 0.16);
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.25);
    }

    .appendix-two-column {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
      gap: 0.95rem;
      margin-top: 0.45rem;
      margin-bottom: 0.75rem;
      align-items: start;
    }

    .appendix-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.12rem 0.6rem;
      border-radius: 999px;
      font-size: 0.76rem;
      font-weight: 800;
      background: var(--color-primary-soft);
      color: var(--color-primary);
      border: 1px solid rgba(29, 79, 145, 0.14);
      margin-bottom: 0.25rem;
      user-select: none;
    }

    .appendix-badge-soft {
      background: rgba(229, 231, 235, 0.9);
      color: rgba(55, 65, 81, 0.95);
      border-color: rgba(209, 213, 219, 0.75);
    }

    .appendix-footer-note {
      font-size: 0.8rem;
      color: var(--color-text-muted);
      margin-top: 0.75rem;
      line-height: 1.55;
    }

    .back-to-top {
      position: fixed;
      right: 18px;
      bottom: 18px;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transform: translateY(8px);
      transition: opacity var(--transition-fast), transform var(--transition-fast);
    }

    .back-to-top.show {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    @media (prefers-reduced-motion: reduce) {
      .toc-link,
      .back-to-top {
        transition: none !important;
      }
    }

    @media (max-width: 1020px) {
      .appendix-toc-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 900px) {
      .appendix-two-column {
        grid-template-columns: minmax(0, 1fr);
      }

      .appendix-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    @media (max-width: 640px) {
      .appendix-toc-grid {
        grid-template-columns: minmax(0, 1fr);
      }

      .appendix-hero {
        padding: 0.9rem 0.95rem;
      }

      .appendix-title {
        font-size: 1.35rem;
      }
    }
  </style>
</head>

<body data-theme="worldbank-light">
  <a class="skip-link" href="#content">Skip to content</a>

  <main id="content" class="appendix-main" role="main">
    <section class="appendix-hero" aria-labelledby="appendix-title">
      <header class="appendix-header">
        <div class="appendix-title-block">
          <div class="appendix-kicker">Technical appendix and user guide</div>
          <h1 id="appendix-title" class="appendix-title">Farming CBA Decision Tool 2</h1>
          <p class="appendix-subtitle">
            This appendix explains the results snapshot table, Excel-first workflow, simulation, and indicator formulas used by Farming CBA Decision Tool 2.
            All monetary figures in this appendix are expressed in Australian dollars (AUD).
          </p>

          <div class="appendix-meta-row" aria-label="Document metadata">
            <span class="appendix-chip"><span class="dot" aria-hidden="true"></span>Results snapshot matrix</span>
            <span class="appendix-chip"><span class="dot" aria-hidden="true"></span>Excel-first workflow</span>
            <span class="appendix-chip"><span class="dot" aria-hidden="true"></span>Non-prescriptive AI interpretation</span>
          </div>
        </div>

        <div class="appendix-header-actions">
          <a href="index.html" class="btn ghost" aria-label="Back to main tool">Back to main tool</a>
          <button type="button" class="btn" id="printBtn" aria-label="Print this appendix">Print</button>
        </div>
      </header>

      <nav class="appendix-toc" aria-label="Table of contents">
        <p class="toc-title">Contents</p>
        <div class="appendix-toc-grid">
          <a class="toc-link" href="#sec-1">
            <span class="label">1. Purpose</span>
            <span class="hint">How to use this guide</span>
          </a>
          <a class="toc-link" href="#sec-2">
            <span class="label">2. Quick start</span>
            <span class="hint">Two common workflows</span>
          </a>
          <a class="toc-link" href="#sec-3">
            <span class="label">3. Tabs</span>
            <span class="hint">What each tab does</span>
          </a>
          <a class="toc-link" href="#sec-4">
            <span class="label">4. Results snapshot</span>
            <span class="hint">Control vs treatments</span>
          </a>
          <a class="toc-link" href="#sec-5">
            <span class="label">5. Excel workflow</span>
            <span class="hint">Template and import rules</span>
          </a>
          <a class="toc-link" href="#sec-6">
            <span class="label">6. Indicators and formulas</span>
            <span class="hint">PV, NPV, BCR, ROI</span>
          </a>
          <a class="toc-link" href="#sec-7">
            <span class="label">7. Worked example</span>
            <span class="hint">Faba bean scenario</span>
          </a>
          <a class="toc-link" href="#sec-8">
            <span class="label">8. Simulation</span>
            <span class="hint">Uncertainty exploration</span>
          </a>
          <a class="toc-link" href="#sec-9">
            <span class="label">9. AI interpretation</span>
            <span class="hint">Prompt and learning</span>
          </a>
          <a class="toc-link" href="#sec-appendix-end">
            <span class="label">End</span>
            <span class="hint">Reproducibility notes</span>
          </a>
        </div>
      </nav>
    </section>

    <section id="sec-1" class="card appendix-section">
      <h2>1. Purpose of this appendix</h2>
      <p>
        Farming CBA Decision Tool 2 is a decision support tool for comparing farm treatments against a control using common cost benefit analysis (CBA) indicators.
        The tool is designed to make the main results readable at a glance, and to keep detailed explanations optional.
      </p>
      <p>
        This appendix is written for two audiences. The first audience is farmers, advisors, and non-technical users who want practical guidance on how to enter data,
        read the results snapshot, and export outputs for reporting. The second audience is technical users and reviewers who want clarity on formulas, assumptions,
        and how the Excel-first workflow is validated and applied.
      </p>
      <div class="appendix-callout">
        <strong>Key idea:</strong>
        The Results snapshot compares every treatment side by side with the control using a vertical matrix table where indicators are rows and treatments are columns.
        The tool does not hide low-performing treatments. It supports exploration of why results differ and what could change them.
      </div>
    </section>

    <section id="sec-2" class="card appendix-section">
      <h2>2. Quick start: two common workflows</h2>

      <h3>2.1 Workflow A: use the built-in example, then adjust values</h3>
      <p>
        Open the tool and go to the Results snapshot tab. Click Recalculate to ensure all figures are current. Use the ranking metric selector to rank treatments by
        benefit cost ratio, net present value, or return on investment. If you have many treatments, use the Previous columns and Next columns buttons to page across
        the table, without losing the consistent control column.
      </p>
      <p>
        If you want to adjust assumptions without using Excel, visit Time and risk settings to edit discounting, adoption, and risk. Then revisit Results snapshot and
        recalculate. Export the results to Excel for archiving or reporting, and use Copy table for Word for quick pasting into documents.
      </p>

      <h3>2.2 Workflow B: Excel-first, then import and update results</h3>
      <p>
        Go to the Excel workflow tab. Download either a blank Excel template or a scenario template that contains your current inputs. Edit rows in Excel, save the file,
        then select and parse it in the tool. After parsing, apply the file so the tool validates, calibrates IDs where needed, and updates all results automatically.
      </p>
      <div class="appendix-note">
        The Excel-first workflow is designed for reliability and auditability. You keep a copy of the spreadsheet used to generate the results, and you can also save a
        project JSON file from the header to reproduce the full scenario later.
      </div>
    </section>

    <section id="sec-3" class="card appendix-section">
      <h2>3. How each tab in the tool works</h2>

      <h3>3.1 Introduction tab</h3>
      <p>
        The Introduction tab explains what the tool does and links to the main entry points: project setup, Excel workflow, and results snapshot. It does not affect calculations.
      </p>

      <h3>3.2 Project tab</h3>
      <p>
        The Project tab captures the project narrative and metadata used for reporting and audit trails. These fields do not change the CBA calculations, but they provide
        context for interpreting results and exporting reports.
      </p>

      <h3>3.3 Time and risk settings tab</h3>
      <p>
        This tab defines the analysis horizon and core parameters used in present value calculations. It includes discount rates, adoption multipliers, and risk settings.
        It also includes a setting that controls whether project-wide costs and benefits are allocated across treatments by effective area.
      </p>

      <h3>3.4 Outputs tab</h3>
      <p>
        Outputs define the monetised products or outcomes, such as yield, quality premiums, or other measurable outputs. Each output has a value per unit in AUD.
        Treatments reference outputs through treatment output rows.
      </p>

      <h3>3.5 Treatments tab</h3>
      <p>
        Treatments define the control and alternative practices. One treatment must be flagged as the control. Each treatment can include treatment-specific costs and
        output quantities per hectare (or per unit). Treatments are the columns in the Results snapshot table.
      </p>

      <h3>3.6 Additional benefits tab</h3>
      <p>
        This tab captures benefits not represented by output quantities, such as avoided losses, reduced input use, or other savings. These are treated as benefit flows
        and can be assigned year ranges.
      </p>

      <h3>3.7 Other project costs tab</h3>
      <p>
        This tab captures project-wide costs such as coordination, monitoring, extension, or capital items. These costs may be allocated across treatments by effective area,
        depending on the setting in Time and risk settings.
      </p>

      <h3>3.8 Sources tab</h3>
      <p>
        The Sources tab records evidence notes and source tagging. It does not change calculations. It supports traceability of inputs used in the analysis.
      </p>

      <h3>3.9 Results snapshot tab</h3>
      <p>
        This is the main results view. It shows a matrix table with economic indicators as rows and the control plus treatments as columns. It supports a view mode that
        shows absolute values, or differences versus the control. It also supports paging across columns so large treatment sets remain readable.
      </p>

      <h3>3.10 Simulation tab</h3>
      <p>
        The simulation explores uncertainty by varying discount rate, adoption, risk, and selected values. It reports distributions for net present value and benefit cost ratio.
        It is intended for exploration and learning rather than excluding treatments.
      </p>

      <h3>3.11 Excel workflow tab</h3>
      <p>
        This tab supports an Excel-first workflow, with downloads of templates and scenario exports, a robust parsing step, validation feedback, and an apply step that updates
        the scenario and recalculates results.
      </p>

      <h3>3.12 AI interpretation tab</h3>
      <p>
        This tab generates a structured prompt based on current results that can be pasted into a large language model such as Copilot or ChatGPT. The interpretation is designed
        to be plain English, explanatory, and non-prescriptive. It can also suggest practical improvement levers for low-performing treatments as guidance for reflection.
      </p>
    </section>

    <section id="sec-4" class="card appendix-section">
      <h2>4. Results snapshot: how to read the matrix table</h2>

      <h3>4.1 The matrix layout and the role of the control</h3>
      <p>
        The results snapshot table is designed for rapid comparison. Indicators appear as rows and each treatment appears as a column.
        The control appears alongside all treatments so the figures align vertically and can be compared row by row.
      </p>
      <div class="appendix-callout">
        <strong>Minimum indicators shown:</strong>
        present value of benefits, present value of costs, net present value, benefit cost ratio, return on investment, and ranking.
        These indicators are aligned across the control and every treatment.
      </div>

      <h3>4.2 View mode: absolute values versus differences versus control</h3>
      <p>
        In Absolute values mode, each column shows the treatment’s indicator values and the control column is shown alongside as a reference. If Show delta versus control is enabled,
        each treatment can also show a small delta relative to the control within the same cell, so the comparison is immediate without switching modes.
      </p>
      <p>
        In Differences versus control mode, the control is treated as the baseline and each treatment’s cells show how much it differs from the control. This is useful when you want
        to focus on incremental differences rather than absolute totals.
      </p>

      <h3>4.3 Ranking metric and snapshot cards</h3>
      <p>
        The ranking metric selector controls how treatments are ranked for the snapshot. Ranking can be based on benefit cost ratio, net present value, or return on investment.
        The snapshot cards at the top of the Results snapshot tab summarise the best and worst treatments under the chosen ranking metric, and they identify the current control.
      </p>

      <h3>4.4 Many treatments: paging across columns</h3>
      <p>
        If the number of treatments is large, the table can be shown in windows of columns. The Columns per view setting controls how many treatment columns are displayed at once.
        The Previous columns and Next columns buttons page across the treatment set while keeping the layout consistent and readable.
      </p>

      <h3>4.5 Export and reporting from the results snapshot</h3>
      <p>
        The Export results (Excel) button produces a clean spreadsheet with the same matrix orientation, where indicators are rows and treatments (including control) are columns.
        The Copy table for Word button copies a clean, paste-ready version of the table for inclusion in reports. The Print or export PDF option is designed to create a printable
        results page, including the snapshot table.
      </p>

      <div class="appendix-note">
        The results snapshot is intentionally short. Detailed narrative interpretation is optional and is handled through the AI interpretation workflow so that the tool remains
        farmer-friendly and does not impose decision rules.
      </div>
    </section>

    <section id="sec-5" class="card appendix-section">
      <h2>5. Excel-first workflow: templates, validation, and import rules</h2>

      <h3>5.1 What you download</h3>
      <p>
        The Excel workflow supports three downloads. A blank Excel template provides the correct sheet structure and headers. A scenario template includes your current inputs,
        plus an export-only Results sheet so you can keep a complete record of what was run. A sample download includes the built-in example dataset used to demonstrate the tool.
      </p>

      <h3>5.2 What you upload and how the tool applies it</h3>
      <p>
        The import process has two steps. First, you select and parse the Excel file. The tool checks that required sheets and columns exist, then it reads rows and prepares a
        summary of what will change. Second, you apply the parsed Excel file, which updates the scenario, calibrates IDs where needed, and refreshes results.
      </p>
      <div class="appendix-callout">
        <strong>Plain language import rule:</strong>
        Keep sheet names unchanged and do not rename header columns. You can add rows freely. If an ID cell is blank, the tool can generate an ID automatically.
        Numeric columns must be numeric. Year ranges must fall within the analysis horizon.
      </div>

      <h3>5.3 Required sheets and their purpose</h3>
      <div class="appendix-table-wrapper" role="region" aria-label="Excel sheets used by the tool" tabindex="0">
        <table class="appendix-table">
          <thead>
            <tr>
              <th>Sheet</th>
              <th>Purpose in the tool</th>
              <th>What you edit</th>
              <th>Notes on validation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>README</td>
              <td>Short instructions</td>
              <td>Optional</td>
              <td>Not used by calculations</td>
            </tr>
            <tr>
              <td>Project</td>
              <td>Project metadata for reporting</td>
              <td>Text fields and dates</td>
              <td>Safe to edit freely</td>
            </tr>
            <tr>
              <td>Settings</td>
              <td>Time horizon, discounting, adoption, risk, allocation</td>
              <td>Numeric values</td>
              <td>Must be numeric where expected; bounds apply for rates and multipliers</td>
            </tr>
            <tr>
              <td>Outputs</td>
              <td>Output labels, units, values</td>
              <td>Output names, units, values</td>
              <td>Values must be numeric; IDs should be unique if provided</td>
            </tr>
            <tr>
              <td>Treatments</td>
              <td>Treatment definitions including control flag</td>
              <td>Names, control flag, area, costs</td>
              <td>Exactly one control should be flagged; areas and costs must be numeric</td>
            </tr>
            <tr>
              <td>TreatmentOutputs</td>
              <td>Output quantities by treatment with optional year ranges</td>
              <td>Quantities and year ranges</td>
              <td>Quantities numeric; year ranges within analysis horizon</td>
            </tr>
            <tr>
              <td>Benefits</td>
              <td>Project-wide benefits not captured in outputs</td>
              <td>Annual values and year ranges</td>
              <td>Values numeric; year ranges within horizon</td>
            </tr>
            <tr>
              <td>Costs</td>
              <td>Project-wide costs including capital items if used</td>
              <td>Annual values and year ranges</td>
              <td>Values numeric; year ranges within horizon; capital fields optional</td>
            </tr>
            <tr>
              <td>Results</td>
              <td>Snapshot comparison table</td>
              <td>Export-only</td>
              <td>Scenario template includes this sheet for record keeping</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3>5.4 Common import issues and how to avoid them</h3>
      <p>
        The most common issue is renamed sheets or headers. The second most common issue is non-numeric values in numeric columns, such as currency symbols or text notes.
        If you need to keep notes, add a separate notes column that the tool can ignore, or use the Sources tab and project notes inside the tool.
      </p>
      <p>
        Another common issue is year ranges that fall outside the analysis horizon. If the analysis horizon is ten years, a benefit row with an end year beyond that horizon
        will be flagged. Adjust the horizon or the row years so they align.
      </p>
      <div class="appendix-note">
        If you are unsure, start from the scenario template, edit only values you intend to change, and keep structure unchanged. This tends to be the most reliable approach.
      </div>
    </section>

    <section id="sec-6" class="card appendix-section">
      <h2>6. Core indicators and formulas (AUD)</h2>

      <h3>6.1 Present value of benefits and present value of costs</h3>
      <div class="appendix-two-column">
        <div>
          <span class="appendix-badge">Present value (PV)</span>
          <p>
            Present value converts a stream of future cash flows into a single value expressed in today’s dollars. The tool calculates the present value of benefits and costs
            separately, using the discount rate and the analysis horizon.
          </p>
        </div>
        <div>
          <div class="appendix-math">
PV of benefits (AUD) = Σ_{t=0..T} [ Benefit_t (AUD) ÷ (1 + r)^t ]
PV of costs (AUD)    = Σ_{t=0..T} [ Cost_t (AUD) ÷ (1 + r)^t ]
          </div>
        </div>
      </div>

      <h3>6.2 Net present value</h3>
      <div class="appendix-two-column">
        <div>
          <span class="appendix-badge">Net present value (NPV)</span>
          <p>
            NPV is the difference between the present value of benefits and the present value of costs. It is expressed in AUD. A positive NPV means the treatment adds value
            at the chosen discount rate, under the assumptions entered.
          </p>
        </div>
        <div>
          <div class="appendix-math">
NPV (AUD) = PV of benefits (AUD) - PV of costs (AUD)
          </div>
        </div>
      </div>

      <h3>6.3 Benefit cost ratio</h3>
      <div class="appendix-two-column">
        <div>
          <span class="appendix-badge">Benefit cost ratio (BCR)</span>
          <p>
            BCR is the ratio of the present value of benefits to the present value of costs. It is unitless. A BCR above 1 indicates that benefits exceed costs under the
            chosen assumptions. The tool does not impose thresholds. BCR is a descriptive indicator used for comparison and learning.
          </p>
        </div>
        <div>
          <div class="appendix-math">
BCR = PV of benefits (AUD) ÷ PV of costs (AUD)
          </div>
        </div>
      </div>

      <h3>6.4 Return on investment</h3>
      <div class="appendix-two-column">
        <div>
          <span class="appendix-badge">Return on investment (ROI)</span>
          <p>
            ROI expresses the NPV relative to the present value of costs. In practical terms, it describes how much net value is created per dollar of present-valued cost,
            expressed as a percentage.
          </p>
        </div>
        <div>
          <div class="appendix-math">
ROI (percent) = 100 × [ NPV (AUD) ÷ PV of costs (AUD) ]
          </div>
        </div>
      </div>

      <h3>6.5 Differences versus control</h3>
      <p>
        When the Results snapshot is in Differences versus control mode, the tool reports increments relative to the control for each indicator. This supports quick identification of
        which drivers are responsible for changes. For example, a treatment can have higher benefits and higher costs, and the net effect on NPV and BCR is visible immediately.
      </p>
      <div class="appendix-math">
For any indicator X:

ΔX (treatment vs control) = X_treatment - X_control
      </div>

      <h3>6.6 Ranking</h3>
      <p>
        Ranking is determined by your chosen ranking metric. The tool ranks treatments from best to worst based on the selected indicator, without excluding any treatment.
        Ranking is descriptive and depends on your assumptions.
      </p>

      <h3>6.7 Risk combination formula</h3>
      <p>
        If you use the combined risk calculator, the tool combines component risks into a single base risk using a multiplicative form. The combined risk reflects the chance that
        multiple risk factors jointly reduce realised benefits.
      </p>
      <div class="appendix-math">
Let rTech, rNonCoop, rSocio, rFin, rMan be component risks between 0 and 1.

Combined base risk R is:

R = 1 - (1 - rTech) × (1 - rNonCoop) × (1 - rSocio) × (1 - rFin) × (1 - rMan)
      </div>
      <p>
        The risk factor is applied as a reduction to the benefit stream in the scenario. This is a modelling choice intended to keep the tool transparent and farmer-friendly.
      </p>
    </section>

    <section id="sec-7" class="card appendix-section">
      <h2>7. Worked faba bean example (farmer-friendly view)</h2>

      <div class="appendix-callout">
        <strong>Scenario summary</strong>
        <p>
          You are comparing a soil amendment treatment against your usual practice (control). The treatment increases yield but also increases labour and input costs.
          You want to see whether the added benefits outweigh the costs over the analysis horizon, expressed in AUD.
        </p>
      </div>

      <h3>7.1 Outputs and values</h3>
      <p>
        Define an output such as faba bean grain yield, with unit tonnes per hectare and a value per unit such as AUD 600 per tonne. This converts yield differences into
        monetised benefits.
      </p>

      <h3>7.2 Control and treatment setup</h3>
      <p>
        Create one treatment flagged as the control, and one or more treatments flagged as alternatives. Enter treatment labour cost and input cost assumptions in AUD.
        Enter output quantities per hectare by treatment, including year ranges if effects apply only in some years.
      </p>

      <h3>7.3 Adoption and allocation</h3>
      <p>
        Set adoption multipliers on the Time and risk settings tab. Adoption acts as a multiplier on each treatment’s effective area. If you choose to allocate project-wide items
        by area, project-wide costs and benefits are distributed across treatments proportional to their effective area.
      </p>

      <h3>7.4 Reading the results snapshot table</h3>
      <p>
        Go to Results snapshot and click Recalculate. In the matrix table, compare the control column to each treatment column for present value of benefits, present value of costs,
        NPV, BCR, and ROI. If you want to emphasise increments, switch to Differences versus control mode. If you prefer to keep absolute values but still see differences, keep
        Absolute values mode and enable Show delta versus control.
      </p>
      <p>
        If a treatment has higher benefits than control but costs rise even more, you will typically see a smaller NPV gain than expected, and a lower BCR relative to other options.
        The matrix format helps you see this immediately without searching through narrative text.
      </p>

      <h3>7.5 Using low performance as a learning opportunity</h3>
      <p>
        If a treatment performs poorly on BCR or NPV, the tool keeps it visible. This supports learning. Poor performance usually reflects one or more drivers: costs too high,
        benefits too low, adoption too limited, risk too large, or timing that delays benefits. The AI interpretation workflow can help summarise these drivers and suggest
        practical improvement levers as guidance for reflection.
      </p>
    </section>

    <section id="sec-8" class="card appendix-section">
      <h2>8. Simulation: exploring uncertainty (not decision rules)</h2>

      <h3>8.1 What the simulation varies</h3>
      <p>
        The Monte Carlo simulation varies discount rate, adoption, risk, and optionally selected values for outputs and costs. Variation ranges are defined by low and high fields and
        the simulation variation size. The purpose is to explore uncertainty and identify which treatments are sensitive to assumptions.
      </p>

      <h3>8.2 What the simulation reports</h3>
      <p>
        The simulation reports summary statistics for NPV and BCR, including minimum, maximum, mean, and median. It also reports probabilities such as the probability that NPV is
        greater than zero and the probability that BCR exceeds reference values used for reporting. These reference values are descriptive and do not impose thresholds.
      </p>

      <div class="appendix-math">
Example for a value X (AUD) and variation size v percent:

Lower bound = X × (1 - v/100)
Upper bound = X × (1 + v/100)

Sampled value = Uniform(Lower bound, Upper bound)
      </div>

      <p>
        A practical way to use simulation is to compare treatments not only by their base-case ranking, but also by how often they remain favourable across plausible ranges of
        adoption, risk, and prices.
      </p>
    </section>

    <section id="sec-9" class="card appendix-section">
      <h2>9. AI-assisted interpretation: prompt generation and learning support</h2>

      <h3>9.1 What the AI tab does and does not do</h3>
      <p>
        The AI interpretation tab generates a structured prompt based on your scenario, settings, and results. You copy and paste this prompt into your preferred model (for example
        Copilot or ChatGPT). The tool does not send your data anywhere. It does not make decisions and it does not dictate what you should do.
      </p>

      <h3>9.2 What the prompt asks the model to produce</h3>
      <p>
        The prompt is designed to produce a plain-English interpretation of the results that explains what indicators mean, highlights better and worse performers, and describes the
        drivers behind performance. It also includes a learning and improvement component: when a treatment performs poorly, the prompt asks for realistic ways performance could be
        improved, such as reducing costs, increasing yield, improving prices, improving agronomic practice reliability, or adjusting timing and scale of implementation.
      </p>

      <h3>9.3 Optional policy briefs and printable outputs</h3>
      <p>
        The AI interpretation tab includes a space where you can paste the AI-generated interpretation back into the tool. You can then download it as a Word-friendly file, download it
        as plain text, or print it to PDF. This supports longer narrative briefs without hard-coded decision rules.
      </p>

      <div class="appendix-note">
        A good practice is to save the scenario JSON and the Excel workbook used for inputs alongside the AI-generated brief, so a reader can reproduce the results and understand the
        assumptions behind the narrative.
      </div>

      <div id="sec-appendix-end" class="appendix-footer-note">
        This appendix should be stored with the project JSON files and any Excel workbooks used for the analysis. This supports reproducibility and makes it easier for future users to
        trace how each AUD input was defined and how the results snapshot was produced.
      </div>
    </section>
  </main>

  <button type="button" class="btn primary back-to-top" id="backToTop" aria-label="Back to top">
    Back to top
  </button>

  <script>
    (function () {
      const printBtn = document.getElementById("printBtn");
      if (printBtn) {
        printBtn.addEventListener("click", () => window.print());
      }

      const backToTop = document.getElementById("backToTop");
      const onScroll = () => {
        if (!backToTop) return;
        const y = window.scrollY || document.documentElement.scrollTop || 0;
        backToTop.classList.toggle("show", y > 600);
      };

      if (backToTop) {
        backToTop.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));
      }

      window.addEventListener("scroll", onScroll, { passive: true });
      onScroll();
    })();
  </script>
</body>
</html>
