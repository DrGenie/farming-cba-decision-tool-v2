/* =========================================================
   Farming CBA Decision Aid Tool — styles.css
   Mobile-first, government-facing, accessible UI.
   Styles only target IDs/classes present in index.html.
   ========================================================= */

:root{
  --bg: #f5f7fb;
  --bg-2: #eef2f8;
  --card: #ffffff;
  --text: #0f172a;
  --muted: #475569;
  --muted-2:#64748b;

  --border: #e2e8f0;
  --border-2:#cbd5e1;

  --primary:#0b3a6a;
  --primary-2:#0e4a87;
  --primary-soft:#e7f0fb;

  --good:#166534;
  --good-soft:#eaf7ee;
  --bad:#991b1b;
  --bad-soft:#fdecec;
  --warn:#b45309;
  --warn-soft:#fff4d6;
  --neutral:#334155;
  --neutral-soft:#eef2f6;

  --focus:#2563eb;

  --shadow: 0 10px 28px rgba(15, 23, 42, 0.08);
  --shadow-soft: 0 8px 22px rgba(15, 23, 42, 0.06);

  --r-card: 16px;
  --r-pill: 999px;
  --r-input: 12px;

  --font: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  --t-fast: 160ms ease-out;
  --t-med: 220ms ease-out;

  --sticky-top: 0px; /* updated dynamically by layout, but safe default */
}

*,
*::before,
*::after{ box-sizing:border-box; }

html, body{ margin:0; padding:0; }

body[data-theme="worldbank-light"]{
  min-height:100vh;
  font-family:var(--font);
  color:var(--text);
  background:
    radial-gradient(1200px 700px at 15% 0%, #ffffff 0%, #f1f6ff 32%, var(--bg) 70%),
    linear-gradient(180deg, var(--bg) 0%, var(--bg-2) 100%);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

/* =========================================================
   Global containers
   ========================================================= */

#appShell{
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

.app-main{
  width:100%;
  max-width:1240px;
  margin: 0 auto;
  padding: 1rem 1rem 2.25rem;
}

/* =========================================================
   Top navigation
   ========================================================= */

#topNav.app-header{
  position:sticky;
  top:0;
  z-index: 120;
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  justify-content:space-between;
  gap:0.75rem 1rem;
  padding: 0.9rem 1rem;
  background: rgba(255,255,255,0.92);
  border-bottom:1px solid rgba(203,213,225,0.75);
  backdrop-filter: blur(10px);
}

.brand{
  display:flex;
  align-items:center;
  gap:0.75rem;
}

.brand-mark{
  width:42px;
  height:42px;
  border-radius: 14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
  font-size:0.9rem;
  letter-spacing:0.08em;
  color:#fff;
  background: radial-gradient(circle at 30% 25%, #3b82f6 0%, #0b3a6a 72%);
  box-shadow: 0 14px 34px rgba(11, 58, 106, 0.28);
}

.brand-title{
  font-weight:700;
  font-size:1rem;
  color:var(--text);
}

.brand-subtitle{
  font-size:0.82rem;
  color:var(--muted-2);
}

.header-links{
  display:flex;
  align-items:center;
  gap:0.5rem;
}

.nav-link{
  display:inline-flex;
  align-items:center;
  gap:0.35rem;
  padding:0.42rem 0.7rem;
  border-radius: var(--r-pill);
  border:1px solid rgba(203,213,225,0.9);
  background:#fff;
  color:var(--primary);
  text-decoration:none;
  font-size:0.86rem;
  font-weight:600;
  transition: background var(--t-fast), transform var(--t-fast), border-color var(--t-fast), color var(--t-fast);
}

.nav-link:hover{
  background: var(--primary-soft);
  border-color: rgba(37,99,235,0.35);
  transform: translateY(-1px);
}

.nav-link:focus-visible{
  outline: none;
  box-shadow: 0 0 0 3px rgba(37,99,235,0.25);
  border-color: rgba(37,99,235,0.55);
}

/* =========================================================
   Blocking banner
   ========================================================= */

#globalBlockingBanner.blocking-banner{
  width:100%;
  max-width:1240px;
  margin: 0.9rem auto 0;
  padding: 0 1rem;
}

.blocking-inner{
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  justify-content:space-between;
  gap:0.75rem;
  padding: 0.85rem 1rem;
  border-radius: var(--r-card);
  border: 1px solid rgba(180,83,9,0.25);
  background: var(--warn-soft);
  box-shadow: var(--shadow-soft);
}

.blocking-text{
  color: #7c2d12;
  font-size: 0.92rem;
}

.blocking-actions{
  display:flex;
  align-items:center;
  gap:0.5rem;
}

/* =========================================================
   Tabs
   ========================================================= */

#tabBar.tabs-nav{
  display:flex;
  flex-wrap:wrap;
  gap:0.4rem;
  padding:0.45rem;
  background: rgba(255,255,255,0.82);
  border: 1px solid rgba(203,213,225,0.8);
  border-radius: 18px;
  box-shadow: var(--shadow-soft);
  margin: 1rem 0 1rem;
}

.tab-link{
  appearance:none;
  border: none;
  background: transparent;
  color: var(--muted);
  font-weight:700;
  font-size:0.85rem;
  padding: 0.5rem 0.85rem;
  border-radius: var(--r-pill);
  cursor:pointer;
  transition: background var(--t-fast), color var(--t-fast), transform var(--t-fast), box-shadow var(--t-fast);
  white-space:nowrap;
}

.tab-link:hover{
  background: rgba(226,232,240,0.8);
  color: var(--text);
}

.tab-link.active{
  background: var(--primary);
  color:#fff;
  box-shadow: 0 10px 22px rgba(11, 58, 106, 0.28);
  transform: translateY(-1px);
}

.tab-link:focus-visible{
  outline:none;
  box-shadow: 0 0 0 3px rgba(37,99,235,0.25);
}

#tabPanels .tab-panel{
  display:none;
  animation: fadeIn 180ms ease-out;
}
#tabPanels .tab-panel.active,
#tabPanels .tab-panel.show{
  display:block;
}

@keyframes fadeIn{
  from{ opacity:0; transform: translateY(4px); }
  to{ opacity:1; transform: translateY(0); }
}

/* =========================================================
   Cards, headings, text helpers
   ========================================================= */

.card{
  background: var(--card);
  border: 1px solid rgba(226,232,240,0.95);
  border-radius: var(--r-card);
  box-shadow: var(--shadow);
  padding: 1rem 1rem;
  margin-bottom: 1rem;
}

.card.subtle{
  box-shadow: var(--shadow-soft);
  background: linear-gradient(180deg, #ffffff 0%, #fbfdff 100%);
}

.h2{ font-size:1.35rem; margin:0 0 0.35rem; color:var(--text); font-weight:800; }
.h3{ font-size:1.05rem; margin:0 0 0.35rem; color:var(--text); font-weight:800; }
.h4{ font-size:0.98rem; margin:0 0 0.35rem; color:var(--text); font-weight:800; }

h1, h2, h3, h4, p{ margin:0 0 0.5rem; }
p{ line-height: 1.55; }

.small{ font-size:0.86rem; }
.muted{ color: var(--muted); }

.prose{
  color: var(--text);
  line-height:1.65;
  font-size:0.95rem;
}
.prose p{ margin:0 0 0.7rem; }
.prose p:last-child{ margin-bottom:0; }

/* =========================================================
   Panel headers and toolbars
   ========================================================= */

.panel-header{
  display:flex;
  flex-wrap:wrap;
  align-items:flex-start;
  justify-content:space-between;
  gap:0.75rem;
  margin-bottom: 0.7rem;
}

.panel-actions{
  display:flex;
  flex-wrap:wrap;
  gap:0.45rem;
}

.toolbar{
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  gap:0.45rem;
  margin-top: 0.4rem;
}

/* =========================================================
   Buttons
   ========================================================= */

.btn{
  appearance:none;
  border: 1px solid rgba(203,213,225,0.95);
  background:#fff;
  color: var(--text);
  border-radius: var(--r-pill);
  padding: 0.48rem 0.95rem;
  font-size:0.88rem;
  font-weight:700;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:0.35rem;
  transition: transform var(--t-fast), background var(--t-fast), border-color var(--t-fast), box-shadow var(--t-fast), color var(--t-fast);
  white-space:nowrap;
}

.btn:hover{
  background: rgba(241,245,249,0.9);
  transform: translateY(-1px);
}

.btn:active{ transform: translateY(0); }

.btn.primary{
  background: var(--primary);
  color:#fff;
  border-color: transparent;
  box-shadow: 0 10px 22px rgba(11, 58, 106, 0.26);
}
.btn.primary:hover{
  background: var(--primary-2);
  box-shadow: 0 12px 26px rgba(11, 58, 106, 0.30);
}

.btn.ghost{
  background: rgba(255,255,255,0.8);
  color: var(--primary);
  border-color: rgba(203,213,225,0.95);
}

.btn.small{
  padding: 0.38rem 0.75rem;
  font-size:0.84rem;
}

.btn:disabled{
  opacity:0.55;
  cursor:not-allowed;
  transform:none;
  box-shadow:none;
}

/* =========================================================
   Forms
   ========================================================= */

.field{
  display:flex;
  flex-direction:column;
  gap:0.35rem;
}

.field label{
  font-size:0.86rem;
  font-weight:800;
  color: #334155;
}

.field input,
.field select,
.field textarea{
  width:100%;
  border-radius: var(--r-input);
  border: 1px solid rgba(226,232,240,0.95);
  background:#fff;
  color: var(--text);
  padding: 0.55rem 0.65rem;
  font-size:0.92rem;
  transition: border-color var(--t-fast), box-shadow var(--t-fast), background var(--t-fast);
}

.field textarea{ resize: vertical; min-height: 86px; }

.field input:focus,
.field select:focus,
.field textarea:focus{
  outline:none;
  border-color: rgba(37,99,235,0.55);
  box-shadow: 0 0 0 3px rgba(37,99,235,0.18);
  background: #fbfdff;
}

.mono{ font-family: var(--mono); }

/* Inline row inputs */
.input-row{
  display:flex;
  gap:0.5rem;
  align-items:center;
}
.input-row input{ flex:1 1 auto; }

/* =========================================================
   Grid helpers
   ========================================================= */

.row-2, .row-3, .row-4{
  display:grid;
  gap:0.85rem;
  margin-bottom:0.85rem;
}

.row-2{ grid-template-columns: 1fr; }
.row-3{ grid-template-columns: 1fr; }
.row-4{ grid-template-columns: 1fr; }

/* =========================================================
   Scenario bar, filters, segmented controls
   ========================================================= */

.scenario-bar{
  display:grid;
  grid-template-columns: 1fr;
  gap: 0.85rem;
  padding: 0.85rem;
  border-radius: var(--r-card);
  border: 1px solid rgba(226,232,240,0.95);
  background: linear-gradient(180deg, #ffffff 0%, #f9fbff 100%);
  box-shadow: var(--shadow-soft);
  margin: 0.8rem 0 0.8rem;
}

.filter-bar{
  display:flex;
  flex-wrap:wrap;
  gap:0.55rem;
  align-items:center;
  justify-content:flex-start;
  margin: 0.65rem 0 0.85rem;
}

.filter-group{
  display:flex;
  flex-wrap:wrap;
  gap:0.45rem;
}

.scale-toggle .label{
  font-size:0.86rem;
  font-weight:800;
  color:#334155;
  margin-bottom:0.2rem;
}

.segmented{
  display:flex;
  flex-wrap:wrap;
  gap:0.35rem;
  padding: 0.35rem;
  border-radius: 16px;
  border: 1px solid rgba(226,232,240,0.95);
  background: rgba(241,245,249,0.7);
}

.seg{
  display:inline-flex;
  align-items:center;
  gap:0.35rem;
  border-radius: var(--r-pill);
  padding: 0.35rem 0.65rem;
  background:#fff;
  border: 1px solid rgba(226,232,240,0.95);
  cursor:pointer;
  user-select:none;
  transition: background var(--t-fast), transform var(--t-fast), border-color var(--t-fast);
}

.seg:hover{
  background: rgba(241,245,249,0.8);
  transform: translateY(-1px);
}

.seg input{
  width:auto;
  margin:0;
}

.seg span{
  font-size:0.86rem;
  font-weight:800;
  color: var(--text);
}

.seg input:focus-visible + span{
  outline:none;
}

/* =========================================================
   Step cards, banners
   ========================================================= */

.step-card{
  border-radius: var(--r-card);
  border: 1px solid rgba(226,232,240,0.95);
  background: #fff;
  box-shadow: var(--shadow-soft);
  padding: 0.9rem 0.9rem;
  margin-bottom: 0.9rem;
}

.step-head{
  display:flex;
  align-items:flex-start;
  gap:0.75rem;
  margin-bottom:0.65rem;
}

.step-num{
  min-width:42px;
  height:42px;
  border-radius: 14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  color:#fff;
  background: var(--primary);
  box-shadow: 0 10px 20px rgba(11, 58, 106, 0.22);
}

.step-title p{ margin:0.15rem 0 0; }

.banner{
  border-radius: 14px;
  padding: 0.65rem 0.8rem;
  border: 1px solid rgba(226,232,240,0.95);
  font-weight:800;
  font-size:0.88rem;
}

.banner.warning{
  background: var(--warn-soft);
  border-color: rgba(180,83,9,0.25);
  color: #7c2d12;
}

.banner.danger{
  background: var(--bad-soft);
  border-color: rgba(153,27,27,0.25);
  color: #7f1d1d;
}

/* =========================================================
   Metrics
   ========================================================= */

.metric{
  display:flex;
  flex-direction:column;
  gap:0.15rem;
}

.metric .label{
  font-size:0.82rem;
  color: var(--muted-2);
  font-weight:800;
}

.metric .value{
  font-size:0.98rem;
  font-weight:900;
  color: var(--text);
}

.value.small{ font-size:0.92rem; }

/* Value cues (used when JS applies these classes) */
.val-good{ color: var(--good); }
.val-bad{ color: var(--bad); }
.val-neutral{ color: var(--neutral); }

.bg-good{ background: var(--good-soft); }
.bg-bad{ background: var(--bad-soft); }
.bg-neutral{ background: var(--neutral-soft); }

/* =========================================================
   Tables: generic
   ========================================================= */

.table-scroll{
  width:100%;
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  border-radius: 14px;
}

.table-scroll.wide{
  border: 1px solid rgba(226,232,240,0.95);
  background:#fff;
  box-shadow: var(--shadow-soft);
}

.data-table{
  width:100%;
  border-collapse: separate;
  border-spacing:0;
  font-size:0.9rem;
  min-width: 740px;
}

.data-table thead th{
  background: #f1f5fb;
  color: #0f172a;
  font-weight:900;
  padding: 0.7rem 0.75rem;
  border-bottom: 1px solid rgba(203,213,225,0.95);
  text-align:left;
  vertical-align:bottom;
}

.data-table tbody td{
  padding: 0.65rem 0.75rem;
  border-bottom: 1px solid rgba(226,232,240,0.95);
  color: var(--text);
  vertical-align:top;
  background:#fff;
}

.data-table tbody tr:nth-child(even) td{
  background: #fbfdff;
}

.data-table tbody tr:hover td{
  background: rgba(231,240,251,0.55);
}

/* =========================================================
   Comparison table sticky header + sticky indicator and control columns
   - Indicator column = first column
   - Control column = second column (by construction)
   ========================================================= */

.comparison-scroll{
  max-height: 70vh;
}

#resComparisonTable.comparison-table thead th{
  position: sticky;
  top: 0;
  z-index: 10;
}

#resComparisonTable.comparison-table thead th:first-child{
  left: 0;
  z-index: 30;
}

#resComparisonTable.comparison-table thead th:nth-child(2){
  left: 240px; /* updated for first column width; see below */
  z-index: 28;
}

#resComparisonTable.comparison-table tbody td:first-child{
  position: sticky;
  left: 0;
  z-index: 20;
  background: #f7faff;
  font-weight:900;
  color: #0f172a;
  border-right: 1px solid rgba(226,232,240,0.95);
}

#resComparisonTable.comparison-table tbody td:nth-child(2){
  position: sticky;
  left: 240px;
  z-index: 18;
  background: #fbfdff;
  font-weight:900;
  border-right: 1px solid rgba(226,232,240,0.95);
}

/* Set stable widths for sticky columns */
#resComparisonTable.comparison-table thead th:first-child,
#resComparisonTable.comparison-table tbody td:first-child{
  min-width: 240px;
  max-width: 240px;
}

#resComparisonTable.comparison-table thead th:nth-child(2),
#resComparisonTable.comparison-table tbody td:nth-child(2){
  min-width: 190px;
  max-width: 190px;
}

/* Make delta columns visually distinct when JS adds classes */
.delta-cell{
  font-weight:900;
}

/* =========================================================
   Leaderboard
   ========================================================= */

.leaderboard-wrap{ margin-top: 0.9rem; }
.leaderboard-head{ margin-bottom: 0.4rem; }

/* =========================================================
   Chips (dynamic content placed into #cfgDiscountList and #cfgPriceList)
   ========================================================= */

.chip-list{
  display:flex;
  flex-wrap:wrap;
  gap:0.45rem;
  margin-top:0.45rem;
}

#cfgDiscountList > * ,
#cfgPriceList > *{
  display:inline-flex;
  align-items:center;
  gap:0.35rem;
  padding:0.35rem 0.6rem;
  border-radius: var(--r-pill);
  border:1px solid rgba(203,213,225,0.95);
  background: rgba(241,245,249,0.75);
  font-weight:900;
  color: var(--text);
  font-size:0.85rem;
}

/* =========================================================
   Diagnostics list
   ========================================================= */

.diag-list{
  display:flex;
  flex-direction:column;
  gap:0.6rem;
  font-size:0.92rem;
  color: var(--text);
}

/* =========================================================
   Footer
   ========================================================= */

.app-footer{
  width:100%;
  max-width:1240px;
  margin: 0 auto 1.25rem;
  padding: 0 1rem;
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  justify-content:space-between;
  gap:0.75rem;
  color: var(--muted-2);
  font-size:0.88rem;
}

.footer-right a.nav-link{
  padding:0.3rem 0.65rem;
  font-size:0.84rem;
}

/* =========================================================
   Tooltip bubble (#tooltipBubble) — used for elements with data-tip
   ========================================================= */

#tooltipBubble{
  position: fixed;
  z-index: 1400;
  max-width: 320px;
  padding: 0.55rem 0.65rem;
  border-radius: 14px;
  background: rgba(15, 23, 42, 0.96);
  color: #f8fafc;
  font-size: 0.84rem;
  line-height: 1.35;
  box-shadow: 0 18px 40px rgba(0,0,0,0.25);
  pointer-events: none;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity var(--t-fast), transform var(--t-fast);
}

#tooltipBubble[data-show="true"]{
  opacity: 1;
  transform: translateY(0);
}

/* =========================================================
   Toast host (#toastHost) bottom-right
   - JS creates children; CSS targets children generically
   ========================================================= */

#toastHost{
  position: fixed;
  right: 12px;
  bottom: 12px;
  z-index: 1600;
  display:flex;
  flex-direction:column;
  gap:0.55rem;
  pointer-events:none;
  width: min(420px, calc(100vw - 24px));
}

#toastHost > div{
  pointer-events:none;
  border-radius: 16px;
  border: 1px solid rgba(226,232,240,0.95);
  background: rgba(255,255,255,0.96);
  box-shadow: 0 16px 34px rgba(15,23,42,0.18);
  padding: 0.75rem 0.85rem;
  color: var(--text);
  font-size: 0.9rem;
  font-weight: 800;
}

#toastHost > div strong{
  display:block;
  font-weight: 900;
  margin-bottom: 0.15rem;
}

#toastHost > div .muted{
  font-weight: 800;
  color: var(--muted);
}

/* Allow JS to mark toast types via inline style or extra classes
   without relying on class selectors (rule-safe). */
#toastHost > div[data-kind="success"]{
  border-color: rgba(22,101,52,0.22);
  background: rgba(234,247,238,0.98);
}
#toastHost > div[data-kind="warning"]{
  border-color: rgba(180,83,9,0.22);
  background: rgba(255,244,214,0.98);
}
#toastHost > div[data-kind="danger"]{
  border-color: rgba(153,27,27,0.22);
  background: rgba(253,236,236,0.98);
}
#toastHost > div[data-kind="info"]{
  border-color: rgba(11,58,106,0.22);
  background: rgba(231,240,251,0.98);
}

/* =========================================================
   Responsive enhancements (scale up)
   ========================================================= */

@media (min-width: 640px){
  .app-main{ padding: 1.1rem 1.25rem 2.5rem; }

  #topNav.app-header{
    padding: 0.95rem 1.25rem;
  }

  #globalBlockingBanner.blocking-banner{
    padding: 0 1.25rem;
  }

  .card{ padding: 1.1rem 1.15rem; }

  .row-2{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .row-3{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
  .row-4{ grid-template-columns: repeat(4, minmax(0, 1fr)); }

  .scenario-bar{
    grid-template-columns: repeat(3, minmax(0, 1fr));
    align-items:end;
  }

  .scenario-bar .scale-toggle{
    grid-column: 1 / -1;
  }
}

@media (min-width: 900px){
  #tabBar.tabs-nav{
    padding:0.5rem;
    border-radius: 999px;
  }

  .tab-link{
    font-size:0.86rem;
  }

  .scenario-bar{
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }

  .scenario-bar .scale-toggle{
    grid-column:auto;
  }
}

/* =========================================================
   Print
   ========================================================= */

@media print{
  body[data-theme="worldbank-light"]{
    background:#fff;
  }

  #toastHost,
  #tooltipBubble,
  #tabBar,
  #globalBlockingBanner,
  #topNav{
    display:none !important;
  }

  .app-main{
    max-width:none;
    margin:0;
    padding:0;
  }

  .card{
    box-shadow:none;
    border:none;
    border-radius:0;
    page-break-inside: avoid;
  }

  .table-scroll.wide{
    box-shadow:none;
    border:1px solid #d1d5db;
  }

  .btn{ display:none !important; }
}

/* =========================================================
   Reduced motion
   ========================================================= */

@media (prefers-reduced-motion: reduce){
  *{
    scroll-behavior:auto !important;
    transition:none !important;
    animation:none !important;
  }
}
